---
title: "CLion Tests with Nucleo G0"
date: 2025-05-03
draft: false
---

## CLion Tests with Nucleo G0

### CLion Test in Embedded Development

#### Current Experience with Different Environments and Editors

Recently, I had the chance to work in the CLion environment, so I decided to test it out in the context of Embedded development. I used CLion for a mini-project for university in C++, and it was great to write in, so I figured it would be worth trying it out for an Embedded project too. My experiences with different IDEs for Embedded, like CubeIDE, CrossStudio, or VSC with extensions, haven't been too impressive so far (they were okay, but something was always missing). I usually work with STM32 processors. The goal was to see if CLion makes debugging and code writing easier (one IDE without extra editors). I also wanted to avoid using OpenOCD (it doesn't always seem like a stable solution to me â€“ I've had bad experiences debugging Zephyr on Windows).

In CubeIDE, the sluggish performance annoyed me, but on the flip side, when generating a project directly from CubeIDE (using the environment's wizards), the project worked right away. I mean, after creating it and clicking 'Build', and then 'Run'/'Debug', the debugging session or firmware upload just happened without having to mess around with settings. That doesn't change the fact that I find it hard to write in CubeIDE (I'm used to Visual Studio Code), so I ended up writing code in VSC and debugging it in CubeIDE. Recently, CubeMX added the ability to generate CMake-type projects, which came in handy when I was doing my CLion tests.

Using Visual Studio Code was the opposite: I was familiar with writing and reading code in that editor, but setting up the debugger requires a few steps that boil down to editing a couple of .json files.

CrossStudio is similar to STM32CubeIDE for me, except that generating a project prevents you from using the manufacturer's libraries directly in the project generator. This can be a bit of a problem if (like me) you usually need those libraries because you want to test something and not necessarily write a whole complex application from scratch. CrossStudio runs faster than CubeIDE and also has a convenient setup with the STM debugger.

### Mini-Test

The test setup was as follows:

* **Nucleo G071RB** ([link to board](https://www.st.com/en/evaluation-tools/nucleo-g071rb.html))
* **CLion 2025.1** ([link to CLion](https://www.jetbrains.com/clion/))
* **STM32CubeCLT** ([link to STM32CubeCLT](https://www.st.com/en/development-tools/stm32cubeclt.html))
* **STM32CubeMX 6.14.1** ([link to STM32CubeMX](https://www.st.com/en/development-tools/stm32cubemx.html))
* **arm-none-eabi-gcc 10.3** ([link to gcc](https://developer.arm.com/Tools%20and%20Software/GNU%20Toolchain))
* My old, unfinished (ðŸ˜…) football timer project [[repository](https://github.com/dunajski/football_timer)]
* **Windows 11**

I already had CubeMX and CLion installed. CLion suggested I install CubeCLT to generate the project correctly.

>   As I'm writing this, JetBrains is introducing new features for Embedded Development, especially for STM32. It'll be worth testing them out in the future to fairly compare the capabilities.

I started by reading the documentation on running projects from a `.ioc` file ([link to section](https://www.jetbrains.com/help/clion/2025.1/embedded-development.html?Embedded_Development&keymap=VSCode#open-project)). However, it seems to me that this method will soon become obsolete, considering that CubeMX now allows generating projects with the CMake toolchain. ![cube\_mx\_wybor\_toolchaina](/images/cube_mx_cmake.png)

The method from the JetBrains documentation didn't work correctly, so I decided to try the one available directly in CLion. After selecting the option **File -> New -> Project -> STM32CubeMX**, a window popped up that allowed me to load the project. It worked without any issues, but it works best for new projects generated by CubeMX where the CMake toolchain was selected from the start.

#### Clean Project vs. Old Project

If you have the option, try testing CLion on fresh projects with the CMake toolchain selected. In my case, I had to take a few steps in CubeMX: I saved my old project in a new location, changed the toolchain to CMake, and regenerated the project. I also manually added the files to CMakeLists.txt.

```c
# Add sources to executable
target_sources(${CMAKE_PROJECT_NAME} PRIVATE
    # Add user sources here
        ${CMAKE_SOURCE_DIR}/Core/Src/buttons.c
        ${CMAKE_SOURCE_DIR}/Core/Src/menus.c
        ${CMAKE_SOURCE_DIR}/Core/Src/game.c
)
```

### Debugging

After a few minor issues with CLion, CMake, and CubeMX, I finally managed to build the project (the default is `ctrl + shift + B` in CLion). Then, I configured a debug session using the ST-Link GDB server, which turned out to be extremely helpful thanks to the [JetBrains documentation](https://www.jetbrains.com/help/clion/2025.1/embedded-gdb-server.html?Embedded_Development&keymap=VSCode&utm_source=product&utm_medium=link&utm_campaign=CL&utm_content=2025.1).

Using the **New Embedded GDB Server Run Configuration** window, I created a configuration that started the debug session when I pressed F5. ![new_emb_gdb_server](/images/new_emb_gdb_server.png)

My configuration was named `stm-gdb`, and now pressing F5 starts the debug session. ![debug\_session](/images/debug_session.png)

I also had to add the .svd file from the manufacturer to be able to view the MCU register values in the **Peripherals** tab.

### Evaluation

I'd give my initial evaluation of CLion tests in Embedded using Nucleo G071RB and STM32CubeMX a **4/5**. After some initial configuration hiccups, CLion provides convenient tools for writing and debugging code. Similar environments (like CubeIDE) offer easier debugger configuration, but CLion works well, especially with CMake-based projects. I can't give it a higher rating because CLion crashed a few times when switching projects, and things weren't as smooth for an existing (non-new) project.

That said, the tests were pretty superficial, so to have a more solid opinion, I'd need to spend more time using CLion. Which doesn't change the fact that I intend to use it for future projects now, and I'm not discouraged.
